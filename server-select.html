<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Castle Wars - Server Selection</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Press Start 2P', cursive;
            color: #fff;
        }
        
        .container {
            text-align: center;
            padding: 20px;
        }
        
        h1 {
            color: #ffe066;
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 3px 3px 0px #000;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 3px 3px 0px #000, 0 0 10px #ffe066; }
            to { text-shadow: 3px 3px 0px #000, 0 0 20px #ffe066, 0 0 30px #ffe066; }
        }
        
        .subtitle {
            color: #4ecdc4;
            font-size: 16px;
            margin-bottom: 50px;
        }
        
        .server-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .server-card {
            background: rgba(0, 0, 0, 0.7);
            border: 3px solid #ffe066;
            border-radius: 15px;
            padding: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .server-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 224, 102, 0.5);
            border-color: #4ecdc4;
        }
        
        .server-card h2 {
            color: #ffe066;
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .server-card .mode {
            color: #4ecdc4;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .server-card .description {
            color: #ccc;
            font-size: 12px;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        
        .server-card .status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            font-size: 10px;
        }
        
        .online {
            color: #4ecdc4;
        }
        
        .offline {
            color: #ff6b6b;
        }
        
        .player-count {
            color: #ffe066;
        }
        
        .join-button {
            background: linear-gradient(135deg, #ffe066 0%, #ffcc00 100%);
            color: #1a1a2e;
            border: none;
            padding: 15px 30px;
            font-size: 14px;
            font-family: 'Press Start 2P', cursive;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
            width: 100%;
        }
        
        .join-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 224, 102, 0.5);
        }
        
        .join-button:active {
            transform: scale(0.95);
        }
        
        .loading {
            display: none;
            color: #4ecdc4;
            margin-top: 30px;
            font-size: 14px;
        }
        
        .error {
            display: none;
            color: #ff6b6b;
            margin-top: 30px;
            font-size: 12px;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 32px;
            }
            
            .server-card h2 {
                font-size: 18px;
            }
            
            .server-card .description {
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CASTLE WARS</h1>
        <div class="subtitle">Choose Your Battlefield</div>
        
        <div class="server-grid">
            <div class="server-card" onclick="joinServer(3000)">
                <h2>PvP Arena</h2>
                <div class="mode">PLAYER VS PLAYER</div>
                <div class="description">
                    Battle against other players<br>
                    Build fortresses<br>
                    Dominate the leaderboard<br>
                    Classic deathmatch action
                </div>
                <div class="status">
                    <span class="online" id="pvp-status">CHECKING...</span>
                    <span class="player-count" id="pvp-players">-- players</span>
                </div>
                <button class="join-button">JOIN BATTLE</button>
            </div>
            
            <div class="server-card" onclick="joinServer(3001)">
                <h2>PvE Survival</h2>
                <div class="mode">COOPERATIVE MODE</div>
                <div class="description">
                    Team up with friends<br>
                    Fight waves of monsters<br>
                    Defend your base<br>
                    Survive together
                </div>
                <div class="status">
                    <span class="online" id="pve-status">CHECKING...</span>
                    <span class="player-count" id="pve-players">-- players</span>
                </div>
                <button class="join-button">JOIN CO-OP</button>
            </div>
        </div>
        
        <div class="loading" id="loading">Connecting to server...</div>
        <div class="error" id="error"></div>
    </div>
    
    <script>
        // Check server status on load
        window.addEventListener('load', () => {
            checkServerStatus(3000, 'pvp');
            checkServerStatus(3001, 'pve');
            
            // Refresh status every 5 seconds
            setInterval(() => {
                checkServerStatus(3000, 'pvp');
                checkServerStatus(3001, 'pve');
            }, 5000);
        });
        
        async function checkServerStatus(port, serverId) {
            try {
                // Try to connect to the server's socket.io endpoint
                const response = await fetch(`${window.location.protocol}//${window.location.hostname}:${port}/socket.io/?EIO=4&transport=polling&t=${Date.now()}`, {
                    method: 'GET',
                    mode: 'cors',
                    cache: 'no-cache'
                });
                
                if (response.ok) {
                    document.getElementById(`${serverId}-status`).textContent = 'ONLINE';
                    document.getElementById(`${serverId}-status`).className = 'online';
                    
                    // In a real implementation, you'd get actual player count from the server
                    // For now, we'll just show it's online
                    document.getElementById(`${serverId}-players`).textContent = '? players';
                } else {
                    setOffline(serverId);
                }
            } catch (error) {
                setOffline(serverId);
            }
        }
        
        function setOffline(serverId) {
            document.getElementById(`${serverId}-status`).textContent = 'OFFLINE';
            document.getElementById(`${serverId}-status`).className = 'offline';
            document.getElementById(`${serverId}-players`).textContent = '0 players';
        }
        
        function joinServer(port) {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('error').style.display = 'none';
            
            // Redirect to the game server
            const gameUrl = `${window.location.protocol}//${window.location.hostname}:${port}`;
            
            // Add a small delay for the loading animation
            setTimeout(() => {
                window.location.href = gameUrl;
            }, 500);
        }
        
        // Handle direct URL parameters (e.g., ?server=pvp)
        const urlParams = new URLSearchParams(window.location.search);
        const server = urlParams.get('server');
        if (server === 'pvp') {
            joinServer(3000);
        } else if (server === 'pve') {
            joinServer(3001);
        }
    </script>
</body>
</html>